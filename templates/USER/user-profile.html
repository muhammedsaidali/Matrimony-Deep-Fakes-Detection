{% extends 'USER/userBase.html' %}
{% block header %}
{% load static %}

<style>
    /* Image Upload */

    #file-input {
        display: none;
    }

    /* 
    #img {
        cursor: pointer;
        height: 150px;
        width: 150px;
        padding: 10px;
        border-radius: 100px;
    } */

    article,
    aside,
    figure,
    footer,
    header,
    hgroup,
    menu,
    nav,
    section {
        display: block;
    }

    /* Image upload */
</style>

<div class="col-md-8 col-lg-9">
    <div class="row">
        <div class="col-md-12 col-lg-6 col-xl-8 db-sec-com">
            <h2 class="db-tit">Profile Details</h2>
            <div class="db-profile">
                <div class="img">
                    {% if mydata.image == '' %}
                    <img src="{% static 'images/dummy.png' %}" style="border-radius: 50%;height: 125px;width: 125px;"
                        alt="">
                    {% else %}
                    <img src="/static/media/{{mydata.image}}" id="img0" alt="">
                    {% endif %}
                </div>
                <div class="edit">
                    <a href="/editProfile" class="cta-dark">Edit Profile</a>
                </div>
            </div>
        </div>
        <div class="col-md-12 col-lg-6 col-xl-4 db-sec-com">
            <h2 class="db-tit">&nbsp;</h2>
            <div class="db-pro-stat">
                <h6>My Profile</h6>
                <div class="db-pro-pgog" style="background: transparent;">
                    {% if mydata.image == '' %}
                    <div class="image-upload text-center" style="margin-top: -50px;">
                        <label for="file-input">
                            <img id="img" src="{% static 'images/dummy.png' %}" alt="Upload Image" title="Upload Image"
                                style="height: 130px;width: 130px;margin-top:45%;border-radius: 40%;" />
                        </label>
                        <input id="file-input" required onchange="readURL(this)" name="imgfile" type="file" />
                    </div>
                    {% else %}
                    <div class="image-upload text-center" style="margin-top: -50px;">
                        <label for="file-input">
                            <img id="img" src="/static/media/{{mydata.image}}" alt="Upload Image" title="Upload Image"
                                style="height: 130px;width: 130px;margin-top:45%;border-radius: 40%;" />
                        </label>
                        <input id="file-input" required onchange="readURL(this)" name="imgfile" type="file" />
                    </div>
                    {% endif %}
                    {{mem}}
                </div>
                <ul class="pro-stat-ic">
                    <li>
                        <span>
                            <i class="fa fa-heart-o like" aria-hidden="true"></i>
                            <b>{{mydata.likes}}</b>Likes
                        </span>
                    </li>
                    <li>
                        <span>
                            <i class="fa fa-handshake-o inte" aria-hidden="true"></i>
                            <b>{{mydata.intrests}}</b>Interests
                        </span>
                    </li>
                    <li></li>
                    <li class="mt-3"></li>
                </ul>
            </div>
        </div>
    </div>
</div>
</div>
</div>
</div>
</section>
<!-- END -->
<script>
    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                // Set the image source locally
                $("#img").attr("src", e.target.result);
                $("#img0").attr("src", e.target.result);
                $("#img1").attr("src", e.target.result);

                // Send the image data to the Django server
                uploadProfilePic(input.files[0]);
            };

            reader.readAsDataURL(input.files[0]);
        }
    }

    function uploadProfilePic(file) {
        var formData = new FormData();
        formData.append('file', file);

        $.ajax({
            url: '/uploadProfilePic/',  // Replace with your Django view URL
            type: 'POST',
            data: formData,
            processData: false,
            contentType: false,
            success: function (response) {
                console.log('Image uploaded successfully:', response);
                // You can handle the response from the server here
                // window.location.href='/profile/'
            },
            error: function (error) {
                console.error('Error uploading image:', error);
            }
        });
    }
</script>
{% endblock %}